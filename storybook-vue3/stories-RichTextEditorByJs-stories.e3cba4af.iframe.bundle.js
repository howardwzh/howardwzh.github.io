"use strict";(self.webpackChunkstorybook_vue3=self.webpackChunkstorybook_vue3||[]).push([[753],{"./src/stories/RichTextEditorByJs.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>RichTextEditorByJs_stories});var vue_esm_bundler=__webpack_require__("./node_modules/.pnpm/vue@3.5.13_typescript@5.7.2/node_modules/vue/dist/vue.esm-bundler.js");const RichTextEditorByJsvue_type_script_setup_true_lang_ts=(0,vue_esm_bundler.pM)({__name:"RichTextEditorByJs",props:(0,vue_esm_bundler.zz)({color:{default:"#333333"}},{modelValue:{default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(__props){const props=__props,content=(0,vue_esm_bundler.fn)(__props,"modelValue"),colorfullTextareaRef=(0,vue_esm_bundler.KR)(null),tempStop=(0,vue_esm_bundler.KR)(!1);function onInput(event){if(!tempStop.value){var selection=window.getSelection();if(selection&&selection?.rangeCount){removeExtraBlankString();var range=selection.getRangeAt(0).cloneRange();if(range.collapsed){var node=range.startContainer,offset=range.startOffset;if(("span"!==(node?.parentElement).tagName.toLowerCase()||(node?.parentElement).style.color!==function hexToRgb(hex){3===(hex=hex.replace(/^#/,"")).length&&(hex=hex.split("").map((char=>char+char)).join(""));const bigint=parseInt(hex,16);return`rgb(${bigint>>16&255}, ${bigint>>8&255}, ${255&bigint})`}(props.color))&&node.nodeType===Node.TEXT_NODE&&null!==event.data){const eventText=event.data??"";var newRange=document.createRange();newRange.setStart(node,offset-eventText.length),newRange.setEnd(node,offset);var span=document.createElement("span");span.style.color=props.color,newRange.surroundContents(span),selection.removeAllRanges(),range.setStartAfter(span),selection.addRange(range)}}colorfullTextareaRef.value?.childNodes.forEach((child=>{(child.nodeType===Node.TEXT_NODE&&""===child.textContent||1===colorfullTextareaRef.value?.childNodes.length&&child.nodeType===Node.ELEMENT_NODE&&""===child.textContent)&&colorfullTextareaRef.value?.removeChild(child)})),content.value=flattenStyledHtmlToHtmlString(colorfullTextareaRef.value?.innerHTML||"")}}}function removeExtraBlankString(){const selection=window.getSelection();if(!selection||!selection?.rangeCount)return;const range=selection.getRangeAt(0),startContainer=range.startContainer;if(startContainer.nodeType===Node.TEXT_NODE){const textBeforeCursor=startContainer.textContent;if(textBeforeCursor&&textBeforeCursor.startsWith("​")){const newText=textBeforeCursor.slice(1);startContainer.textContent=newText,range.setStart(startContainer,newText.length),range.setEnd(startContainer,newText.length),selection.removeAllRanges(),selection.addRange(range)}}}function onCompositionStart(){tempStop.value=!0}function onCompositionEnd(event){tempStop.value=!1,onInput(event)}function flattenStyledHtmlToHtmlString(html){function parseHTMLString(htmlString){const doc=(new DOMParser).parseFromString(htmlString,"text/html");return Array.from(doc.body.children)}function mergeStyledStrings(str1,str2){const nodes1=parseHTMLString(str1),nodes2=parseHTMLString(str2),lastSpan1=nodes1[nodes1.length-1],firstSpan2=nodes2[0],lastStyle1=lastSpan1?.getAttribute("style")||"",firstStyle2=firstSpan2?.getAttribute("style")||"";let result="";return lastStyle1&&lastStyle1===firstStyle2&&(lastSpan1.innerHTML+=firstSpan2.innerHTML,nodes2.shift()),nodes1.concat(nodes2).forEach((node=>{result+=node.outerHTML})),result}return function traverse(node,parentStyle){let result="";if(node.nodeType===Node.TEXT_NODE){const textContent=node.textContent?.trim();textContent&&"​"!==textContent&&(result+=`<span style="${function styleToString(style){return Object.entries(style).map((([key,value])=>`${key}: ${value}`)).join("; ")}(parentStyle)}">${textContent}</span>`)}else if(node.nodeType===Node.ELEMENT_NODE){const element=node;/div|br/.test(element.tagName.toLowerCase())&&(result+="<br>");const mergedStyle=function mergeStyles(parentStyle,childStyle){const style={};return["color"].forEach((prop=>{const styleValue=childStyle[prop]||parentStyle[prop];styleValue&&(style[prop]=styleValue)})),style}(parentStyle,element.style);for(let i=0;i<node.childNodes.length;i++){result=mergeStyledStrings(result,traverse(node.childNodes[i],mergedStyle))}}return result}((new DOMParser).parseFromString(html,"text/html").body,{}).replace(/(<br>)+$/,"").replace("​","")}function setSelectedTextStyle(color){const selection=window.getSelection();if(selection&&selection.rangeCount>0){const range=selection.getRangeAt(0),selectedContent=function getStyledRangeContent(extractContents){const tempContainer=document.createElement("div");tempContainer.appendChild(extractContents);let html=tempContainer.innerHTML;return html=html.replace(/<\/div>$/g,"").replace(/<\/?div>/g,"<br>").replace(/<\/?span[^>]*>/g,""),html}(range.cloneContents()),span=document.createElement("span");span.style.color=color,span.innerHTML=selectedContent??"",range.deleteContents(),range.insertNode(span),content.value=flattenStyledHtmlToHtmlString(colorfullTextareaRef.value?.innerHTML||"")}}function handleKeydown(event){"Enter"===event.key?function handleEnter(event){event.preventDefault();const selection=window.getSelection();if(selection&&selection.rangeCount>0){const range=selection.getRangeAt(0),br=document.createElement("br"),blank=document.createTextNode("​");range.insertNode(blank),range.insertNode(br),range.setStartAfter(blank),range.setEndAfter(blank),selection.removeAllRanges(),selection.addRange(range)}content.value=flattenStyledHtmlToHtmlString(colorfullTextareaRef.value?.innerHTML||"")}(event):"Backspace"===event.key&&function handleBackspace(event){const selection=window.getSelection();if(selection&&selection.rangeCount>0){const range=selection.getRangeAt(0),startContainer=range.startContainer,offset=range.startOffset;if(startContainer.nodeType===Node.ELEMENT_NODE&&offset>0){const prevNode=startContainer.childNodes[offset-1],prevprevNode=prevNode.previousSibling;prevNode.nodeType===Node.TEXT_NODE&&"​"===prevNode.textContent&&(removeExtraBlankString(),prevprevNode&&range.setStartAfter(prevprevNode),range.collapse(!0),selection.removeAllRanges(),selection.addRange(range))}else startContainer.nodeType===Node.TEXT_NODE&&"​"===startContainer.textContent&&removeExtraBlankString()}}()}return(0,vue_esm_bundler.wB)((()=>props.color),(newColor=>{setSelectedTextStyle(newColor)})),(_ctx,_cache)=>((0,vue_esm_bundler.uX)(),(0,vue_esm_bundler.CE)("div",{class:"colorful-textarea",contenteditable:"true",onInput,onCompositionstart:onCompositionStart,onCompositionend:onCompositionEnd,onKeydown:handleKeydown,ref_key:"colorfullTextareaRef",ref:colorfullTextareaRef},null,544))}});var injectStylesIntoStyleTag=__webpack_require__("./node_modules/.pnpm/style-loader@3.3.4_webpack@5.97.1_esbuild@0.24.0_/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__("./node_modules/.pnpm/style-loader@3.3.4_webpack@5.97.1_esbuild@0.24.0_/node_modules/style-loader/dist/runtime/styleDomAPI.js"),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__("./node_modules/.pnpm/style-loader@3.3.4_webpack@5.97.1_esbuild@0.24.0_/node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__("./node_modules/.pnpm/style-loader@3.3.4_webpack@5.97.1_esbuild@0.24.0_/node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__("./node_modules/.pnpm/style-loader@3.3.4_webpack@5.97.1_esbuild@0.24.0_/node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__("./node_modules/.pnpm/style-loader@3.3.4_webpack@5.97.1_esbuild@0.24.0_/node_modules/style-loader/dist/runtime/styleTagTransform.js"),styleTagTransform_default=__webpack_require__.n(styleTagTransform),RichTextEditorByJsvue_type_style_index_0_id_d290ae3a_scoped_true_lang_css=__webpack_require__("./node_modules/.pnpm/css-loader@6.11.0_webpack@5.97.1_esbuild@0.24.0_/node_modules/css-loader/dist/cjs.js??clonedRuleSet-8.use[1]!./node_modules/.pnpm/vue-loader@16.8.3_@vue+compiler-sfc@3.5.13_vue@3.5.13_typescript@5.7.2__webpack@5.97.1_esbuild@0.24.0_/node_modules/vue-loader/dist/stylePostLoader.js!./node_modules/.pnpm/postcss-loader@8.1.1_postcss@8.4.49_typescript@5.7.2_webpack@5.97.1_esbuild@0.24.0_/node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[0]!./node_modules/.pnpm/vue-loader@16.8.3_@vue+compiler-sfc@3.5.13_vue@3.5.13_typescript@5.7.2__webpack@5.97.1_esbuild@0.24.0_/node_modules/vue-loader/dist/index.js??ruleSet[0]!./src/components/RichTextEditorByJs.vue?vue&type=style&index=0&id=d290ae3a&scoped=true&lang=css"),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(RichTextEditorByJsvue_type_style_index_0_id_d290ae3a_scoped_true_lang_css.A,options);RichTextEditorByJsvue_type_style_index_0_id_d290ae3a_scoped_true_lang_css.A&&RichTextEditorByJsvue_type_style_index_0_id_d290ae3a_scoped_true_lang_css.A.locals&&RichTextEditorByJsvue_type_style_index_0_id_d290ae3a_scoped_true_lang_css.A.locals;const __exports__=(0,__webpack_require__("./node_modules/.pnpm/vue-loader@16.8.3_@vue+compiler-sfc@3.5.13_vue@3.5.13_typescript@5.7.2__webpack@5.97.1_esbuild@0.24.0_/node_modules/vue-loader/dist/exportHelper.js").A)(RichTextEditorByJsvue_type_script_setup_true_lang_ts,[["__scopeId","data-v-d290ae3a"]]),RichTextEditorByJs=__exports__;__exports__.__docgenInfo={exportName:"default",displayName:"RichTextEditorByJs",description:"",tags:{},props:[{name:"color",required:!0,type:{name:"string"},defaultValue:{func:!1,value:"'#333333'"}}],sourceFiles:["/Users/future/Desktop/projects/storybook-vue3/src/components/RichTextEditorByJs.vue"]};const RichTextEditorByJs_stories={title:"Components/RichTextEditorByJs",component:RichTextEditorByJs},Default=(args=>({components:{RichTextEditorByJs},setup(){const color=(0,vue_esm_bundler.KR)(args.color??"#00ff00"),content=(0,vue_esm_bundler.KR)("");return{args,color,changeColor:c=>{color.value=c},content}},template:'\n    <div style="height: 100vh; display: flex; flex-direction: column; width:70vw;">\n      <RichTextEditorByJs v-bind="args" v-model="content" :color="color" style="border:1px solid #333;" />\n      <div style="display:flex;gap:8px; padding: 8px 0;">\n      <button @mousedown.prevent="changeColor(\'#000000\')" style="background-color:#000000"></button>\n      <button @mousedown.prevent="changeColor(\'#E73879\')" style="background-color:#E73879"></button>\n      <button @mousedown.prevent="changeColor(\'#BF2EF0\')" style="background-color:#BF2EF0"></button>\n      <button @mousedown.prevent="changeColor(\'#FFA24C\')" style="background-color:#FFA24C"></button>\n      <button @mousedown.prevent="changeColor(\'#640D5F\')" style="background-color:#640D5F"></button>\n      </div>\n      <div style="width:100%;">{{content}}</div>\n    </div>\n  '})).bind({});Default.args={};const __namedExportsOrder=["Default"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:'args => ({\n  components: {\n    RichTextEditorByJs\n  },\n  setup() {\n    const color = ref(args.color ?? "#00ff00");\n    const content = ref("");\n    const changeColor = c => {\n      color.value = c;\n    };\n    return {\n      args,\n      color,\n      changeColor,\n      content\n    };\n  },\n  template: `\n    <div style="height: 100vh; display: flex; flex-direction: column; width:70vw;">\n      <RichTextEditorByJs v-bind="args" v-model="content" :color="color" style="border:1px solid #333;" />\n      <div style="display:flex;gap:8px; padding: 8px 0;">\n      <button @mousedown.prevent="changeColor(\'#000000\')" style="background-color:#000000"></button>\n      <button @mousedown.prevent="changeColor(\'#E73879\')" style="background-color:#E73879"></button>\n      <button @mousedown.prevent="changeColor(\'#BF2EF0\')" style="background-color:#BF2EF0"></button>\n      <button @mousedown.prevent="changeColor(\'#FFA24C\')" style="background-color:#FFA24C"></button>\n      <button @mousedown.prevent="changeColor(\'#640D5F\')" style="background-color:#640D5F"></button>\n      </div>\n      <div style="width:100%;">{{content}}</div>\n    </div>\n  `\n})',...Default.parameters?.docs?.source}}}},"./node_modules/.pnpm/css-loader@6.11.0_webpack@5.97.1_esbuild@0.24.0_/node_modules/css-loader/dist/cjs.js??clonedRuleSet-8.use[1]!./node_modules/.pnpm/vue-loader@16.8.3_@vue+compiler-sfc@3.5.13_vue@3.5.13_typescript@5.7.2__webpack@5.97.1_esbuild@0.24.0_/node_modules/vue-loader/dist/stylePostLoader.js!./node_modules/.pnpm/postcss-loader@8.1.1_postcss@8.4.49_typescript@5.7.2_webpack@5.97.1_esbuild@0.24.0_/node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[0]!./node_modules/.pnpm/vue-loader@16.8.3_@vue+compiler-sfc@3.5.13_vue@3.5.13_typescript@5.7.2__webpack@5.97.1_esbuild@0.24.0_/node_modules/vue-loader/dist/index.js??ruleSet[0]!./src/components/RichTextEditorByJs.vue?vue&type=style&index=0&id=d290ae3a&scoped=true&lang=css":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_pnpm_css_loader_6_11_0_webpack_5_97_1_esbuild_0_24_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/css-loader@6.11.0_webpack@5.97.1_esbuild@0.24.0_/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_pnpm_css_loader_6_11_0_webpack_5_97_1_esbuild_0_24_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_pnpm_css_loader_6_11_0_webpack_5_97_1_esbuild_0_24_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_pnpm_css_loader_6_11_0_webpack_5_97_1_esbuild_0_24_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/css-loader@6.11.0_webpack@5.97.1_esbuild@0.24.0_/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_pnpm_css_loader_6_11_0_webpack_5_97_1_esbuild_0_24_0_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_pnpm_css_loader_6_11_0_webpack_5_97_1_esbuild_0_24_0_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,"\n.colorful-textarea[data-v-d290ae3a] {\n    min-height: 200px;\n    color: black;\n    padding: 1px;\n}\n[contenteditable='true'][data-v-d290ae3a]:focus {\n    outline: none;\n}\n","",{version:3,sources:["webpack://./src/components/RichTextEditorByJs.vue"],names:[],mappings:";AAqRE;IACE,iBAAiB;IACjB,YAAY;IACZ,YAAY;AACd;AAEA;IACE,aAAa;AACf",sourcesContent:["<script setup lang=\"ts\">\n  import { ref, watch } from 'vue'\n\n  interface Props {\n    color: string\n  }\n\n  const props = withDefaults(defineProps<Props>(), {\n    color: '#333333',\n  })\n\n  const content = defineModel<string>({ default: '' })\n  const colorfullTextareaRef = ref<HTMLElement | null>(null)\n  const tempStop = ref<Boolean>(false)\n  const blankString = '\\u200B'\n\n  function hexToRgb(hex: string) {\n    hex = hex.replace(/^#/, '')\n    if (hex.length === 3) {\n      hex = hex\n        .split('')\n        .map(char => char + char)\n        .join('')\n    }\n    const bigint = parseInt(hex, 16)\n    const r = (bigint >> 16) & 255\n    const g = (bigint >> 8) & 255\n    const b = bigint & 255\n\n    return `rgb(${r}, ${g}, ${b})`\n  }\n\n  function onInput(event: Event) {\n    if (tempStop.value) return\n    var selection = window.getSelection()\n    if (!selection || !selection?.rangeCount) return\n    removeExtraBlankString()\n\n    var range = selection.getRangeAt(0).cloneRange()\n\n    if (range.collapsed) {\n      var node = range.startContainer\n      var offset = range.startOffset\n\n      if (\n        ((node?.parentElement as HTMLElement).tagName.toLowerCase() !== 'span' ||\n          (node?.parentElement as HTMLElement).style.color !== hexToRgb(props.color)) &&\n        node.nodeType === Node.TEXT_NODE &&\n        (event as InputEvent).data !== null\n      ) {\n        const eventText = (event as InputEvent).data ?? ''\n        var newRange = document.createRange()\n        newRange.setStart(node, offset - eventText.length)\n        newRange.setEnd(node, offset)\n\n        var span = document.createElement('span')\n        span.style.color = props.color\n        newRange.surroundContents(span)\n\n        selection.removeAllRanges()\n        range.setStartAfter(span)\n        selection.addRange(range)\n      }\n    }\n\n    colorfullTextareaRef.value?.childNodes.forEach(child => {\n      if (\n        (child.nodeType === Node.TEXT_NODE && child.textContent === '') ||\n        (colorfullTextareaRef.value?.childNodes.length === 1 &&\n          child.nodeType === Node.ELEMENT_NODE &&\n          child.textContent === '')\n      ) {\n        colorfullTextareaRef.value?.removeChild(child)\n      }\n    })\n\n    content.value = flattenStyledHtmlToHtmlString(colorfullTextareaRef.value?.innerHTML || '')\n  }\n\n  function removeExtraBlankString() {\n    const selection = window.getSelection()\n    if (!selection || !selection?.rangeCount) return\n    const range = selection.getRangeAt(0)\n    const startContainer = range.startContainer\n\n    if (startContainer.nodeType === Node.TEXT_NODE) {\n      const textBeforeCursor = startContainer.textContent\n      if (textBeforeCursor && textBeforeCursor.startsWith(blankString)) {\n        const newText = textBeforeCursor.slice(1)\n        startContainer.textContent = newText\n        range.setStart(startContainer, newText.length)\n        range.setEnd(startContainer, newText.length)\n        selection.removeAllRanges()\n        selection.addRange(range)\n      }\n    }\n  }\n\n  function onCompositionStart() {\n    tempStop.value = true\n  }\n  function onCompositionEnd(event: Event) {\n    tempStop.value = false\n    onInput(event)\n  }\n\n  function flattenStyledHtmlToHtmlString(html: string): string {\n    const parser = new DOMParser()\n    const doc = parser.parseFromString(html, 'text/html')\n\n    function mergeStyles(parentStyle: Record<string, string>, childStyle: CSSStyleDeclaration): Record<string, string> {\n      const style: Record<string, string> = {}\n      const properties = ['color']\n      properties.forEach(prop => {\n        const styleValue = childStyle[prop as any] || parentStyle[prop as any]\n        if (styleValue) style[prop] = styleValue\n      })\n\n      return style\n    }\n\n    function styleToString(style: Record<string, string>): string {\n      return Object.entries(style)\n        .map(([key, value]) => `${key}: ${value}`)\n        .join('; ')\n    }\n    function parseHTMLString(htmlString: string): HTMLElement[] {\n      const parser = new DOMParser()\n      const doc = parser.parseFromString(htmlString, 'text/html')\n      return Array.from(doc.body.children) as HTMLElement[]\n    }\n\n    function mergeStyledStrings(str1: string, str2: string): string {\n      const nodes1 = parseHTMLString(str1)\n      const nodes2 = parseHTMLString(str2)\n      const lastSpan1 = nodes1[nodes1.length - 1] as HTMLElement\n      const firstSpan2 = nodes2[0] as HTMLElement\n      const lastStyle1 = lastSpan1?.getAttribute('style') || ''\n      const firstStyle2 = firstSpan2?.getAttribute('style') || ''\n\n      let result = ''\n\n      if (lastStyle1 && lastStyle1 === firstStyle2) {\n        lastSpan1.innerHTML += firstSpan2.innerHTML\n        nodes2.shift()\n      }\n\n      nodes1.concat(nodes2).forEach(node => {\n        result += node.outerHTML\n      })\n\n      return result\n    }\n\n    function traverse(node: Node, parentStyle: Record<string, string>): string {\n      let result = ''\n\n      if (node.nodeType === Node.TEXT_NODE) {\n        const textContent = node.textContent?.trim()\n        if (textContent && textContent !== blankString) {\n          result += `<span style=\"${styleToString(parentStyle)}\">${textContent}</span>`\n        }\n      } else if (node.nodeType === Node.ELEMENT_NODE) {\n        const element = node as HTMLElement\n        if (/div|br/.test(element.tagName.toLowerCase())) {\n          result += '<br>'\n        }\n        const mergedStyle = mergeStyles(parentStyle, element.style)\n        for (let i = 0; i < node.childNodes.length; i++) {\n          const currentHtml = traverse(node.childNodes[i], mergedStyle)\n          result = mergeStyledStrings(result, currentHtml)\n        }\n      }\n\n      return result\n    }\n\n    return traverse(doc.body, {})\n      .replace(/(<br>)+$/, '')\n      .replace(blankString, '')\n  }\n\n  function setSelectedTextStyle(color: string): void {\n    const selection = window.getSelection()\n    if (selection && selection.rangeCount > 0) {\n      const range = selection.getRangeAt(0)\n      const cloneContents = range.cloneContents()\n      const selectedContent = getStyledRangeContent(cloneContents)\n      const span = document.createElement('span')\n      span.style.color = color\n      span.innerHTML = selectedContent ?? ''\n\n      range.deleteContents()\n      range.insertNode(span)\n\n      content.value = flattenStyledHtmlToHtmlString(colorfullTextareaRef.value?.innerHTML || '')\n    }\n  }\n\n  function getStyledRangeContent(extractContents: any): string {\n    const tempContainer = document.createElement('div')\n    tempContainer.appendChild(extractContents)\n    let html = tempContainer.innerHTML\n    html = html\n      .replace(/<\\/div>$/g, '')\n      .replace(/<\\/?div>/g, '<br>')\n      .replace(/<\\/?span[^>]*>/g, '')\n    return html\n  }\n\n  function handleEnter(event: KeyboardEvent) {\n    event.preventDefault()\n\n    const selection = window.getSelection()\n    if (selection && selection.rangeCount > 0) {\n      const range = selection.getRangeAt(0)\n\n      const br = document.createElement('br')\n      const blank = document.createTextNode(blankString)\n\n      range.insertNode(blank)\n      range.insertNode(br)\n      range.setStartAfter(blank)\n      range.setEndAfter(blank)\n      selection.removeAllRanges()\n      selection.addRange(range)\n    }\n    content.value = flattenStyledHtmlToHtmlString(colorfullTextareaRef.value?.innerHTML || '')\n  }\n  function handleBackspace(event: KeyboardEvent) {\n    const selection = window.getSelection()\n    if (selection && selection.rangeCount > 0) {\n      const range = selection.getRangeAt(0)\n      const startContainer = range.startContainer\n      const offset = range.startOffset\n      if (startContainer.nodeType === Node.ELEMENT_NODE && offset > 0) {\n        const element = startContainer as Element\n        const prevNode = element.childNodes[offset - 1]\n        const prevprevNode = prevNode.previousSibling\n        if (prevNode.nodeType === Node.TEXT_NODE && prevNode.textContent === blankString) {\n          removeExtraBlankString()\n          if (prevprevNode) range.setStartAfter(prevprevNode)\n          range.collapse(true)\n          selection.removeAllRanges()\n          selection.addRange(range)\n        }\n      } else if (startContainer.nodeType === Node.TEXT_NODE && startContainer.textContent === blankString) {\n        removeExtraBlankString()\n      }\n    }\n  }\n  function handleKeydown(event: KeyboardEvent) {\n    if (event.key === 'Enter') {\n      handleEnter(event)\n    } else if (event.key === 'Backspace') {\n      handleBackspace(event)\n    }\n  }\n\n  watch(()=> props.color, (newColor) => {\n    setSelectedTextStyle(newColor)\n  })\n<\/script>\n\n<template>\n  <div\n    class=\"colorful-textarea\"\n    contenteditable=\"true\"\n    @input=\"onInput\"\n    @compositionstart=\"onCompositionStart\"\n    @compositionend=\"onCompositionEnd\"\n    @keydown=\"handleKeydown\"\n    ref=\"colorfullTextareaRef\"\n  />\n</template>\n\n<style scoped>\n  .colorful-textarea {\n    min-height: 200px;\n    color: black;\n    padding: 1px;\n  }\n\n  [contenteditable='true']:focus {\n    outline: none;\n  }\n</style>"],sourceRoot:""}]);const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"./node_modules/.pnpm/vue-loader@16.8.3_@vue+compiler-sfc@3.5.13_vue@3.5.13_typescript@5.7.2__webpack@5.97.1_esbuild@0.24.0_/node_modules/vue-loader/dist/exportHelper.js":(__unused_webpack_module,exports)=>{exports.A=(sfc,props)=>{const target=sfc.__vccOpts||sfc;for(const[key,val]of props)target[key]=val;return target}}}]);